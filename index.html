<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="game-container">
    <div class="grid" id="grid">
    </div>
  </div>
  <script>
    const gridElement = document.getElementById('grid');

    // Charger le plateau initial
    async function loadBoard() {
        const response = await fetch('/get_board');
        console.log(response)
        const board = await response.json();
        renderBoard(board);
    }

    // Afficher le plateau
    function renderBoard(board) {
        gridElement.innerHTML = ''; // Vider la grille
        for (let x = 0; x < board.length; x++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset = x

            // Ajouter les éléments superposés
            board[x].forEach(item => {
                const div = document.createElement('div');
                div.className = 'piece';
                if (item.type === 'Zone') div.classList.add('zone');
                if (item.type === 'Ressource') div.classList.add('ressource');
                div.textContent = item.type;
                cell.appendChild(div);
            });

            // Gérer les clics
            cell.addEventListener('click', () => handleCellClick(x, y));
            gridElement.appendChild(cell);
            
        }
    }

    // Gérer un clic sur une case
    async function handleCellClick(x, y) {
        const response = await fetch('/cell_click', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ x, y })
        });
        const result = await response.json();

        // Recharger le plateau
        await loadBoard();
    }

    // Charger le plateau initial
    loadBoard();
</script>
</body>
</html>
